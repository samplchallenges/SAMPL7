# SAMPL7 PHIP2 protein-ligand analysis scripts

## Manifest
- `./pkganalysis contains the python code use to perform all analysis presented here`
- get_usermap.py: Should be run before (script name); obtains and stores "user map" (really more of a submission map) which lists submission IDs and corresponding file names.
- `RMSD_calculator.py`: Based on D3R Grand Challenge script by Shuai Liu and Conor Parks. (Not used here)
- `RMSD_calculator_HG.py`: Script used to align protein and caculate heavy atoms, symmetry corrected rmsd
- `calculate_ligand_characteristics.py`: Script used to calculate ligand only and ligand-ligand characteristics and descriptors

# SAMPL7 protein-ligand (PHIP2) stage 1  analysis
- Analyses were generated by executing `bash run.sh` in the `/Scripts` directory
- The script generates confusion matrices for all submission at each site individually and groups the results for `ranked`, `non-ranked` and `ranked_and_non-ranked` and submissions and also does a separate analysis for each site. Only site 1 was considered in the paper. 
- The predictions are bootstrapped to evaluate the possible error within each submission
- The balanced accuracies and precision scores are barplotted from the confusion matrices

# SAMPL7 protein-ligand (PHIP2) stage 2  analysis
- Analyses were generated by executing `bash run.sh` in the `/Scripts` directory
- The script generates ligand RMSDs and statistics tables for `ranked`, `non-ranked` and `ranked_and_non-ranked` and submissions

# SAMPL7 protein-ligand (PHIP2) stage 3  analysis
- Analyses were generated by executing `bash run.sh` in the `/Scripts` directory
- The script generates ligand top 10 predictions characteristics and compares whole library vs fragment hits and fragment hits vs top 10 predicted binders