# Results for clip
#
# This file will be automatically parsed.  It must contain the following seven elements:
# predictions, participant name, participant organization, name of method, software listing, method, method category, and ranked.
# These elements must be provided in the order shown.
# The file name must begin with the word "Clip" and then be followed by an underscore or dash.
#
# FILE FORMAT: All comment lines in this file (which begin with #) will be ignored.
# Please use only UTF-8 characters in the non-comment fields. If your information (e.g. your name, etc.)
# contains a non-UTF-8 character, you may note it in comments near that entry.
#
#
# PREDICTIONS
# Please explicitly describe how you handle ions and pKa effects.
#
# The data in each prediction line should be structured as follows, with all (up to six) numbers in kcal/mol.
# host-guest ID (note that the host varies!), Free energy, free energy SEM, free energy model uncertainty,
# enthalpy, enthalpy SEM, enthalpy model uncertainty
# The free energy, free energy SEM, and free energy model uncertainty are REQUIRED.
# The corresponding quantities for binding enthalpy are optional.
#
# Note that the "model uncertainty" should be your estimate of ACCURACY of this particular approach
# for the compound considered.
#
# For the CD challenge, beta CD (bCD) is optional and will not be judged, as
# literature values are available.
# Likewise, for the GDCC challenge, OA binding values for guests 1-6 (but not 7-8)
# are optional as literature values are available.
#
# The list of predictions must begin with the "Prediction:" keyword, as illustrated here.
Predictions:
clip-g1, 3.741, 0.172, 0.369
clip-g2, -1.962, 0.864, 0.447  
clip-g3, -7.396, 2.221, 0.653   
clip-g5, -1.715, 0.667, 0.401   
clip-g6, -4.228, 0.380, 0.502   
clip-g7, -3.039, 2.348, 0.435   
clip-g8, -2.833, 1.868, 0.493
clip-g9, -2.538, 0.405, 0.330   
clip-g10, -1.826, 2.124, 0.587   
clip-g11, -4.417, 0.368, 0.433   
clip-g12, -3.581, 0.405, 0.656  
clip-g15, -1.543, 1.099, 0.686   
clip-g16, 1.816, 1.481, 0.675   
clip-g17, -3.436, 0.507, 0.690  
clip-g18, -2.119, 0.512, 0.726   
clip-g19, -9.098, 0.719, 0.624   
#
#
# Please list your name, using only UTF-8 characters as described above. The "Participant name:" entry is required.
Participant name:
Reference Calculations Mobley Lab
#
#
# Please list your organization/affiliation, using only UTF-8 characters as described above.
Participant organization:
University of California, Irvine
#
#
# Please provide a brief (40 character limit) informal yet informative name of the method used.
# Following is sample text; please edit to your taste.
# The "Name:" keyword is required, as shown here.
# 40 character limit.
Name:
Docking/BCC/GAFF/TIP3P
#
# All major software packages used and their versions
# Following is sample text; please edit to your taste.
# The "Software:" keyword is required.
Software:
ADT/Vina version 1.5.6
YANK version 23.7
AmberTools18
Chimera candidate version 1.13.1
PyMol version 1.7.4
Openeye (QuacpacTK version 2.0.2, OEChemTK version 2.3.0)

#
# Methodology and computational details.
# Level of detail should be at least that used in a publication.
# Please include the values of key parameters, with units, and explain how any
# statistical uncertainties were estimated.
# Use as many lines of text as you need.
# Please explicitly describe how you handle ions (e.g. counterions) and pKa effects
# Following is sample text; please edit to your taste.
# All text following the "Method:" keyword will be regarded as part of your free text methods description.
Method:

Host and guest files in several forms (mol2,pdb, and sdf) were provided from SAMPL7 organizers via Github, and we utilized mol2. 
The protonation state(s) of each molecule were assigned at experimental pH of 7.4 and AM1-BCC charges were added 
using Openeye toolkits when necessary. The updated host and guest mol2 files were converted to PDBQT and the guests were 
docked using AutoDock/Vina. We utilized a docking protocol witha grid search box of 40 cubic Angstroms from the center of the host,
a global search exhaustiveness of 80, and an energy range of 30 kcal/mol between the best and worst binding modes, all to generate
at most 100 binding modes. The grid center was placed at x_y_z coordinates 0.522, 26.377, and 23.956 respecitively. Upon completion,
the pose with the highest docking score was selected for simulations. The docked guest PDBQT file was converted to PDB 
via PyMol. Subsequently, the new guest PDB was process with the chimera program, implicent hydrogens added, protonation states
were inspected, and saved as a mol2. 

Afterwords, openeye tools was used once again to perceive bonds, determine connectivity, and compute atomic formal charges. 
The host, guest, and complex files were parameterized, solvated with TIP3P water model in a cubic box approximately 41 x 41 x 41 cubic
Angstroms via AmberTools antechamber and tleap respectively. In addition to solvation, sodium and chloride counterions were added to 
neutralize the molecules and and additional ions were added to achieve the 20mM experimental concentration. The topology and coordinate 
files (with and without solvent) of the host, guest, and complex were saved as our simulation input files.

All simulations were performed with YANK which uses OpenMM as its simulation engine with CUDA platform in the University of California, San
Diego super computing cluster (TSCC). Explicit absolute free energy calculations were performed using the PMT method at NPT, with temperature 
control using Langevin thermostat at 298K and pressure control by Monte Carlo barostat at 1 atmosphere. Long and short range nonbonded interactions
were set at an 11 Angstrom cutoff, the edge of the solvation box 12 Angstroms away from any atom of host or guest, ewald error tolerance of 0.0001, 
and Lennard-Jones interactions turing on at 10 Angstroms. Harmonic restraints were applied to all systems to keep the ligand from migrating 
away from the "binding" region of the host, yet still be able to explore the area around it. Electrostatic, steric, and restraint lambda values were
determined using YANKs automatic pipeline in a test run with bCD-g2. The lambda values were extracted and incorporated as our protocol for all systems
with a charged guest. 

An initial 500 ps simulation was used to minimize and relax all systems. The simulations contained 61 lambda windows runnning up to 30 ns per window in
an attempt to reduce the free energy prediction uncertainty below 0.5 kcal/mol. The only exception was clip-g1, appeared to be converged by 26 ns. 

NOTE-The majority of the guests that were docked to the "pocket" of the host were linear / aliphatic guests g1-g5, g12, and g16. The remaining guests, majority 
cyclic and aromatic, seem to interact with the "flap" and sulfonic acids on the surface of the host. Therefore, a separate experiment was run on clip-g11, where 
an open conformer of trimertrip was extracted, guest g11 was docked and simulated following the same protocol.

#
#
# METHOD CATEGORY SECTION
#
# State which method category your prediction method is better described as:
# `Alchemical`, `Quantum`, `Other Physical` `Empirical`, `Mixed`, or `Other`.
# Pick only one category label.
# The `Category:` keyword is required.
Category:
Alchemical
#
# All submissions must either be ranked or non-ranked.
# Only one ranked submission per participant is allowed.
# Multiple ranked submissions from the same participant will not be judged.
# Non-ranked submissions are accepted so we can verify that they were made before the deadline.
# The "Ranked:" keyword is required, and expects a Boolean value (True/False)
Ranked:
False
